TrustZone-M Security Overhead Analysis - Complete Comparison

TABLE 1: BINARY SIZE BREAKDOWN
Metric,Jordan's Baseline (No TrustZone),Your Design (With TrustZone),Overhead,Percentage
Secure Firmware (tfm_s.bin),0 bytes,129440 bytes,+129440 bytes,N/A
Non-Secure App (zephyr.bin),119112 bytes,105732 bytes,-13380 bytes,-11.2%
Total Flash Usage,119112 bytes,235172 bytes,+116060 bytes,+97.4%
Build Target,nrf5340dk/nrf5340/cpuapp,nrf5340dk/nrf5340/cpuapp/ns,N/A,N/A
TrustZone Enabled,No,Yes,N/A,N/A

TABLE 2: COMPUTATION TIME (JUST WORKS MODE)
Metric,Jordan's Baseline (No TrustZone),Your Design (With TrustZone),Overhead,Percentage
Pairing Time (milliseconds),3549 ms,2294 ms,-1255 ms,-35.4%
Pairing Time (seconds),3.5 sec,2.3 sec,-1.3 sec,-35.4%
Result,Slower,FASTER,Improvement,35% faster

TABLE 3: CODE COMPLEXITY
Component,Jordan's Baseline,Your Design,Added Lines
Secure Partition Services (BLE_partition.c),0 lines,1867 lines,+1867 lines
Non-Secure Wrappers (src/BLE_partition.c),0 lines,365 lines,+365 lines
Header Files (src/BLE_partition.h),0 lines,157 lines,+157 lines
Total Code Added,0 lines,2389 lines,+2389 lines

TABLE 4: SECURITY PROTECTION
Secret/Key,Jordan's Baseline,Your Design,Protected?
Private Key Storage,Non-secure memory,Secure PSA only,YES
Private Key Export,Accessible,Fails from non-secure,YES
DH Key Storage,Non-secure memory (32 bytes),Secure PSA (ID only 4 bytes),YES
DH Key Export,Accessible,Fails (error -136),YES
MacKey Storage,Non-secure memory,Secure partition memory,YES
MacKey Access,Accessible,No API exists,YES
LTK Storage,Non-secure memory,Secure partition (retrievable),Partial
Security Boundary,None,Hardware TrustZone-M,YES

TABLE 5: SUMMARY COMPARISON
Category,Jordan's Baseline,Your Design,Trade-off
Flash Memory,119 KB,235 KB,Cost: +97% (+113 KB)
Pairing Speed,3.5 seconds,2.3 seconds,Benefit: 35% faster
Code Complexity,0 lines,+2389 lines,Cost: +2389 lines
Private Key Security,Exposed,Protected in secure PSA,Benefit: Hardware isolation
DH Key Security,Exposed,Protected in secure PSA,Benefit: Hardware isolation
MacKey Security,Exposed,Protected in secure partition,Benefit: Hardware isolation
TrustZone,Disabled,Enabled,Benefit: Hardware security

TABLE 6: SERVICES IMPLEMENTED (YOUR DESIGN)
Service,Purpose,Lines of Code,Input,Output
KEYGEN,Generate ECC keypair,~200 lines,None,private_key_id + public key
ECDH,Compute DH shared secret,~250 lines,private_key_id + remote public key,dh_key_id (handle)
F5,Derive MacKey + LTK,~300 lines,dh_key_id + nonces + addresses,Status only (keys stored securely)
F6,Compute DHKey check,~200 lines,dh_key_id + parameters,16-byte check value
GET_LTK,Retrieve LTK for controller,~100 lines,dh_key_id,16-byte LTK
Total,5 services,~1050 lines,,

TABLE 7: TEST CONFIGURATION
Parameter,Value
Hardware,nRF5340 Development Kit
Zephyr Version,4.1.0-rc2
Build Optimization,MinSizeRel
Pairing Mode (Tests),Just Works (BT_SECURITY_L2)
Pairing Mode (Demo),Passkey Display (BT_SECURITY_L4)
Timer API,k_uptime_get()
Measurement Start,Connection established
Measurement End,Pairing complete callback

KEY FINDINGS
Finding,Description
Memory Overhead,TrustZone adds 113 KB (97% increase) to flash memory
Performance,35% FASTER with TrustZone (1.3 seconds improvement)
Code Added,2389 lines of secure partition code
Security Gain,All cryptographic keys protected by hardware isolation
Architecture,Handle-based design - only 4-byte IDs cross security boundary
Simplification,Removed unnecessary slot management (9 fields â†’ 3 fields)

PROJECT INFORMATION
Item,Details
Project Name,Secure BLE Pairing with ARM TrustZone-M
Hardware Platform,nRF5340 Development Kit
Author,Jasmine
Date,November 19 2025
Baseline Commit,b74b092f22ea29950f291104a84e3433f4efd7d6
Current Branch,main
